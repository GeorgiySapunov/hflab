#+title: SHF

|------------------+-------------+---------------------|
| BPG              | SHF 12105 A | 192.168.0.202:50000 |
| DAC              | SHF 614 C   | 192.168.0.204:50000 |
| CLKSRC           | SHF 78122 B |                COM6 |
| PAM4 Multiplexer | SHF 616 C   |  192.168.0.200:5000 |
| EA               | SHF 11104 A |                     |
| Mainframe        | SHF 10000 A |                     |
|------------------+-------------+---------------------|

* INITIALIZATION
** BPG SHF 12105 A 192.168.0.202:50000
#+begin_src bash
BPG:PREEMPHASIS=ENABLE:OFF;
BPG:FIRFILTER=ENABLE:OFF;
BPG:ALLOWNEWCONNECTIONS=ON;

BPG:OUTPUTLEVEL=0;

BPG:AMPLITUDE=Channel1:650 mV,Channel2:650 mV,Channel3:650 mV,Channel4:650 mV,Channel5:650 mV,Channel6:650 mV,Channel7:500 mV,Channel8:500 mV;
BPG:OUTPUT=Channel1:OFF,Channel2:OFF,Channel3:OFF,Channel4:OFF,Channel5:OFF,Channel6:OFF,Channel7:OFF,Channel8:OFF:
BPG:PATTERN=Channel1:PRBS7,Channel2:PRBS7,Channel3:PRBS7,Channel4:PRBS7,Channel5:PRBS7,Channel6:PRBS7;Channel7:PRBS7,Channel8:PRBS7;
BPG:ERRORINJECTION=Channel1:OFF,Channel2:OFF,Channel3:OFF,Channel4:OFF,Channel5:OFF,Channel6:OFF,Channel7:OFF,Channel8:OFF;
BPG:DUTYCYCLEADJUST=Channel1:0,Channel2:0,Channel3:0,Channel4:0,Channel5:0,Channel6:0,Channel7:0,Channel8:0;
BPG:CLOCKINPUT=FULL;
BPG:SELECTABLECLOCK=4;

BPG:SELECTABLEOUTPUT=SELECTABLECLOCK

BPG:USERSETTINGS=SCC.PATTERN TYPE:PRBS7
BPG:FIRFILTER=GO:!PRBS7,G1:!PRBS7;
#+end_src
** DAC SHF 614 C 192.168.0.204:50000
#+begin_src bash
DAC:SYMMETRY=VALUE:0.500;
DAC:OUTPUT=STATE:DISABLED;
#+end_src
** CLKSRC SHF 78122 B COM6
#+begin_src bash
CLKSRC:OUTPUT=OFF;
CLKSRC:AMPLITUDE=3.0;
CUKSRC:FREQUENCY=20000000 Hz;
CLKSRC:TRIGGER=MODE:CLKDIV2,MAX;
CLKSRC:REFERENCE=SOURCE:INTERNAL;
CLKSRC:SSCMODE=MODE:OFF;
CLKSRC:SSCDEVIATION=VALUE:0.00;
CUKSRC:SSCFREQUENCY=VALUE:20000;
CLKSRC:JITTERSOURCE=STATE:OFF;
#+end_src

* NRZ setup
** CLKSRC
#+begin_src bash
CLKSRC:FREQUENCY=30000000000 Hz.
CLKSRC:OUTPUT=ON;
# CLKSRC:OUTPUT=OFF
#         -> CLKSRC:OUTPUT=OFF;
#+end_src
** BPG
#+begin_src bash
BPG:SKEW=Channel1:7 ps
BPG:SKEW=Channel2:6 ps
BPG:SKEW=Channel3:7 ps
BPG:SKEW=Channel4:5 ps;
BPG:SKEW=Channel5:1 ps
BPG:SKEW=Channel6:4 ps

BPG:AMPLITUDE=Channel1:650 mV,Channel2:650 mV,Channel3:650 mV,Channel4:650 mV,Channel5:650 mV,Channel6:650 mV,Channel7:500 mV,Channel8:500 mV;

# PRBS7
BPG:USERSETTINGS=SCC.GRAYCODING:12;
BPG:USERSETTINGS=SCC.PATTERNTYPE:PRBS7
BPG:PREEMPHASIS=ENABLE:OFF,PAMLEVELS:NONE;
BPG:PATTERN=Channel1:PRBS7,Channel2:PRBS7,Channel3:PRBS7,Channel4:PRBS7,Channel5:PRBS7,Channel6:PRBS7;
BPG:FIRFILTER=ENABLE:OFF;
BPG:PAMLEVELS=SCC.PAMORDER:2;
BPG:PAMLEVELS=SCC.L0:0.00%,SCC.L1:100.00%;
BPG:PREEMPHASIS=DAC:SCC,PAMLEVELS:SCC;
BPG:FIRFILTER=G0:!PRBS7,G1:!PRBS7;
BPG:FIRFILTER=G0:!PRBS7,G1:!PRBS7;
BPG:FIRFILTER=FUNCTION:1*y+0;
BPG:PREEMPHASIS=ENABLE:ON;

# channel on
BPG:OUTPUT=Channel1:ON;
BPG:OUTPUT=Channel2:ON;
BPG:OUTPUT=Channel3:ON;
BPG:OUTPUT=Channel4:ON;
BPG:OUTPUT=Channel5:ON;
BPG:OUTPUT=Channel6:ON;

#+end_src
** DAC
* Change pre-emphasis
** BPG
#+begin_src bash
# TAP1 is Main
# TAP0
BPG:PREEMPHASIS=TAP0:10 %;
# BPG:PREEMPHASIS=TAP0:0 %;

# TAP2
BPG:PREEMPHASIS=TAP2:10 %;
# BPG:PREEMPHASIS=TAP2:0 %;

# TAP3
BPG:PREEMPHASIS=TAP3:10 %;
# BPG:PREEMPHASIS=TAP3:0 %;
#+end_src
* Change amplitude
#+begin_src bash
# 100 mV
DAC:SIGNAL=ALIAS:D0,VALUE:1.587302;
        -> DAC:SIGNAL=ALIAS:D0,VALUE:1.59;
DAC:SIGNAL=ALIAS:D1,VALUE:3.174603;
        -> DAC:SIGNAL=ALIAS:D1,VALUE:3.17;
DAC:SIGNAL=ALIAS:D2,VALUE:6.349206;
        -> DAC:SIGNAL=ALIAS:D2,VALUE:6.35;
DAC:SIGNAL=ALIAS:D3,VALUE:12.698413;
        -> DAC:SIGNAL=ALIAS:D3,VALUE:12.70;
DAC:SIGNAL=ALIAS:D4,VALUE:25.396825;
        -> DAC:SIGNAL=ALIAS:D4,VALUE:25,40;
DAC:SIGNAL=ALIAS:D5,VALUE:50.793651;
        -> DAC:SIGNAL=ALIAS:D5,VALUE:50.79;

DAC:OUTPUT=STATE:ENABLED;
# DAC:OUTPUT=STATE:DISABLED;
#+end_src
* Turn off
** CLKSRC
#+begin_src bash
CLKSRC:FREQUENCY=25000000000 Hz.
CLKSRC:OUTPUT=OFF
#+end_src
** BPG
#+begin_src bash
# TAP1 is Main
BPG:PREEMPHASIS=TAP0:0 %;
BPG:PREEMPHASIS=TAP2:0 %;
BPG:PREEMPHASIS=TAP3:0 %;
#+end_src
** DAC
#+begin_src bash
DAC:OUTPUT=STATE:DISABLED;
#+end_src
